/dts-v1/;
/plugin/;

/ {
    compatible = "ti,beaglebone-black";

    /* identification */
    part-number = "BB-SERVITRON-SIX";
    version = "00A0";
    dtbo = "cape-servitron-00A0.dtbo";

    /* state the resources this cape uses or prepare to get winged! */
    exclusive-use =
        /* Quadrature inputs */
        "P8.7", "P8.8", "P8.9",
        "P8.10", "P8.18", "P8.30",
        "P8.34", "P8.36", "P8.37",
        "P8.38", "P8.39", "P8.40",
        "P8.41", "P8.42", "P8.43",
        "P8.44", "P8.45", "P8.46",
        /* Enable and direction pins */
        /* Brake */
        /* Estop/power */
        /* Endstops */
        /* Hardware IP cores in use */
        "pruss"; 

    fragment@0 {
        target = <&am33xx_pinmux>;
        __overlay__ {
            pruicss_quad_pins: pinmux_pruicss_quad_pins{
                pinctrl-single,pins = <
                    // Mode is 0x3f: input turned on, pullup off
                    0x090 0x3f // P8.7  - Q0A - gpmc_advn_ale   GPIO2_2
                    0x094 0x3f // P8.8  - Q0B - gpmc_oen_ren    GPIO2_3
                    0x09c 0x3f // P8.9  - Q0I - gpmc_ben0_cle   GPIO2_5

                    0x098 0x3f // P8.10 - Q1A - gpmc_wen        GPIO2_4
                    0x08c 0x3f // P8.18 - Q1B - gpmc_clk        GPIO2_1
                    0x0ec 0x3f // P8.30 - Q1I - lcd_ac_bias_en  GPIO2_25

                    0x0cc 0x3f // P8.34 - Q2A - lcd_data_11     GPIO2_17
                    0x0c8 0x3f // P8.36 - Q2B - lcd_data_10     GPIO2_16
                    0x0c0 0x3f // P8.37 - Q2I - lcd_data_8      GPIO2_14

                    0x0c4 0x3f // P8.38 - Q3A - lcd_data_9      GPIO2_15
                    0x0b8 0x3f // P8.39 - Q3B - lcd_data_6      GPIO2_12
                    0x0bc 0x3f // P8.40 - Q3I - lcd_data_7      GPIO2_13

                    0x0b0 0x3f // P8.41 - Q4A - lcd_data_4      GPIO2_10
                    0x0b4 0x3f // P8.42 - Q4B - lcd_data_5      GPIO2_11
                    0x0a8 0x3f // P8.43 - Q4I - lcd_data_2      GPIO2_8

                    0x0ac 0x3f // P8.44 - Q5A - lcd_data_3      GPIO2_9
                    0x0a0 0x3f // P8.45 - Q5B - lcd_data_0      GPIO2_6
                    0x0a4 0x3f // P8.46 - Q5I - lcd_data_1      GPIO2_7
                >;
            };

        };
    };

    fragment@1{
        target = <&pruss>;
        __overlay__{
            status = "okay";
            pinctrl-names = "default";
            pinctrl-0       = <&pruicss_quad_pins>;

            quad_0{
                pin-names     = "Servi:q0_a", "Servi:q0_b", "Servi:q0_i";
                gpios         = <&gpio2 2 0x5
                                &gpio2 3 0x5
                                &gpio2 5 0x5>; 
            };            

            quad_1{
                pin-names     = "Servi:q1_a", "Servi:q1_b", "Servi:q1_i";
                gpios         = <&gpio2 4 0x5
                                &gpio2 1 0x5
                                &gpio2 25 0x5>; 
            };            

            quad_2{
                pin-names     = "Servi:q2_a", "Servi:q2_b", "Servi:q2_i";
                gpios         = <&gpio2 17 0x5
                                &gpio2 16 0x5
                                &gpio2 14 0x5>; 
            };            

            quad_3{
                pin-names     = "Servi:q3_a", "Servi:q3_b", "Servi:q3_i";
                gpios         = <&gpio2 15 0x5
                                &gpio2 12 0x5
                                &gpio2 13 0x5>; 
            };            

            quad_4{
                pin-names     = "Servi:q4_a", "Servi:q4_b", "Servi:q4_i";
                gpios         = <&gpio2 10 0x5
                                &gpio2 11 0x5
                                &gpio2 8 0x5>; 
            };            

            quad_5{
                pin-names     = "Servi:q5_a", "Servi:q5_b", "Servi:q5_i";
                gpios         = <&gpio2 9 0x5
                                &gpio2 6 0x5
                                &gpio2 7 0x5>; 
            };            

        };
    };
};
